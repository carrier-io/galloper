<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <style>
        @media screen {
            @font-face {
                font-family: 'Roboto';
                font-style: normal;
                font-weight: 700;
                src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v20/KFOlCnqEu92Fr1MmWUlfBBc4AMP6lQ.woff2) format('woff2');
                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
            }
            @font-face {
                font-family: 'Roboto';
                font-style: normal;
                font-weight: 400;
                src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v20/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');
                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
            }
        }
    </style>
</head>
<body style="background-color:#3D1391; width: 100%; vertical-align: middle; margin: auto; font-family: Roboto, 'Trebuchet MS', Arial, sans-serif; font-weight: 400;">
	<div style="text-align: center; margin: auto; color: white; font-weight: 400; font-size: 14px; width: 80%; padding-top: 20px; max-width: 1000px; min-width: 500px;">
        <h1>Performance Notification</h1>
    </div>
    <div style="width: 80%; border-radius: 8px; margin: auto; background-color: white; max-width: 1000px; min-width: 500px;">
        <table style="padding: 20px; width: 100%; font-size: 14px;">
            <tr>
                <th style = "text-align: left; font-weight: 700; padding-bottom: 10px;">Test Execution Summary</th>
                <th style = "font-weight: 400; text-align: right;">
                    Status
                    <div style="border-radius: 5px; margin: 0px 10px 0px 10px; padding: 5px 10px 5px 10px; display: inline; background-color: {{ t_params.color }}; font-size: 12px; color: white;">
                        {{ t_params.status }}
                    </div>
                </th>
            </tr> 
            {% if t_params.failed_reason|length != 0 %}
            <tr>
                <td colspan="2" style="text-align: right; vertical-align: top;">
                    <ul style="list-style-type:none; padding: 0px; margin-top: 10px;">
            {% for reason in t_params.failed_reason %}
            <li style="padding-bottom: 5px;">{{ reason }}</li>
            {% endfor %}
                    </ul>
                </td>
            </tr>
            {% endif %}
            <tr>
                <td style="text-align: left; vertical-align: top; padding-left: 10px;">Test</td>
                <td style="text-align: right; padding-right: 10px;">{{ t_params.simulation }}</td>
            </tr>
                <tr>
                    <td colspan="2"><hr style="border: 0; height: 1px; background: #f0f0f0;"/></td>
                </tr>
                <tr>
                    <td style="text-align: left; vertical-align: top; padding-left: 10px;">vUser count</td>
                    <td style="text-align: right; padding-right: 10px;">{{ t_params.users }}</td>
                </tr>
                <tr>
                    <td colspan="2"><hr style="border: 0; height: 1px; background: #f0f0f0;"/></td>
                </tr>
                <tr>
                    <td style="text-align: left; vertical-align: top; padding-left: 10px;">Start time</td>
                    <td style="text-align: right; padding-right: 10px;">{{ t_params.start }}</td>
                </tr>
                <tr>
                    <td colspan="2"><hr style="border: 0; height: 1px; background: #f0f0f0;"/></td>
                </tr>
                <tr>
                    <td style="text-align: left; vertical-align: top; padding-left: 10px;">End time</td>
                    <td style="text-align: right; padding-right: 10px;">{{ t_params.end }}</td>
                </tr>
                <tr>
                    <td colspan="2"><hr style="border: 0; height: 1px; background: #f0f0f0;"/></td>
                </tr>
                <tr>
                        <td style="text-align: left; vertical-align: top; padding-left: 10px;">Duration</td>
                        <td style="text-align: right; padding-right: 10px;">{{ t_params.duration }} sec</td>
                </tr>
        </table>
    </div>
    <div style="width: 80%; padding: 5px; margin: auto;"></div>
    <div style="width: 80%; border-radius: 8px; margin: auto; background-color: white; max-width: 1000px; min-width: 500px;">
        <div style="margin: 0 20px 0 20px; padding-top: 20px; padding-bottom: 20px; font-size: 14px;">
            <span style="font-size: 16px; font-weight: 700;">General Metrics</span>
            <table style="width: 100%; text-align: right; padding-top: 5px; padding-bottom: 10px; border-left: 1px solid white;">
                <tr>
                    <th style="background-color: #fbfbfb; padding: 5px; text-align: left;">Metric</th>
                    <th style="background-color: #fbfbfb;">Baseline diff</th>
                    <th style="background-color: #fbfbfb;">Threshold diff</th>
                    <th style="background-color: #fbfbfb; padding-right: 5px;">Current value</th>
                </tr>
                <tr>
                    <td style="text-align: left; vertical-align: top; padding-left: 10px;">Throughput</td>
                    <td style="text-align: right; padding-right: 10px; color:{{ general_metrics.baseline_tp_color }}">
                        {% if general_metrics.baseline_tp > 0 %}
                            + {{ general_metrics.baseline_tp }} req/sec
                        {% else %}
                            {{ general_metrics.baseline_tp }} req/sec
                        {% endif %}
                    </td>
                    <td style="text-align: right; padding-right: 10px; color:{{ general_metrics.threshold_tp_color }}">
                        {% if general_metrics.threshold_tp > 0 %}
                            + {{ general_metrics.threshold_tp }} req/sec
                        {% else %}
                            {{ general_metrics.threshold_tp }} req/sec
                        {% endif %}
                    </td>
                    <td style="text-align: right; padding-right: 10px;">{{ general_metrics.current_tp }} req/sec</td>
                </tr>
                <tr>
                    <td colspan="4"><hr style="border: 0; height: 1px; background: #f0f0f0;"/></td>
                </tr>
                <tr>
                    <td style="text-align: left; vertical-align: top; padding-left: 10px;">Error rate</td>
                    <td style="text-align: right; padding-right: 10px; color: {{ general_metrics.baseline_er_color }}">
                        {% if general_metrics.baseline_er > 0 %}
                            + {{ general_metrics.baseline_er }}%
                        {% else %}
                            {{ general_metrics.baseline_er }}%
                        {% endif %}
                    </td>
                    <td style="text-align: right; padding-right: 10px; color: {{ general_metrics.threshold_er_color }}">
                        {% if general_metrics.threshold_er > 0 %}
                            + {{ general_metrics.threshold_er }}%
                        {% else %}
                            {{ general_metrics.threshold_er }}$
                        {% endif %}
                    </td>
                    <td style="text-align: right; padding-right: 10px;"> {{ general_metrics.current_er }}%</td>
                </tr>
            </table>
            <span style="font-size: 16px; font-weight: 700;">Request Metrics</span>
            <table style="width: 100%; text-align: right; padding-top: 5px;">
                <tr>
                    <th style="width: 30%; background-color: #fbfbfb; padding: 5px; text-align: left; ">Name</th>
                    <th style="width: 10%; background-color: #fbfbfb;">Baseline diff, sec</th>
                    <th style="width: 10%; background-color: #fbfbfb;">Threshold diff, sec</th>
                    <th style="width: 10%; background-color: #fbfbfb;">Current, sec</th>
                    <th style="width: 40%; background-color: #fbfbfb; padding-left: 5px; text-align: left;">Representation</th>
                </tr>
                {% for item in baseline_and_thresholds %}
                <tr>
                    <td style="text-align: left;">
                        <span style="display: inline-block; max-width: 180px; white-space: nowrap; overflow: hidden !important; text-overflow: ellipsis;">
                            {{ item.request_name }}
                        </span>
                    </td>
                    {% if item.baseline is defined %}
                    <td style="color: {{ item.baseline_color }};">
                        {% if item.baseline > 0 %}
                            + {{item.baseline}}
                        {% else %}
                            {{item.baseline}}
                        {% endif %}
                    </td>
                    {% else %}
                    <td></td>
                    {% endif %}
                    <td style="color: {{ item.threshold_color }};">
                        {% if item.threshold > 0 %}
                            + {{item.threshold}}
                        {% else %}
                            {{item.threshold}}
                        {% endif %}
                    </td>
                    <td>{{ item.response_time }}</td>
                    <td style="padding-right: 5px; padding-left: 5px;">
                        <hr style="border: 8px solid {{ item.line_color }}; border-radius: 2px; width: {{ item.share }}%; float: left;" />
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <div style="width: 80%; padding: 5px; margin: auto;"></div>
    <div style="width: 80%; border-radius: 8px; margin: auto; background-color: white; max-width: 1000px; min-width: 500px;">
        <div style="margin: 0 20px 0 20px; padding-top: 20px; padding-bottom: 20px; font-size: 14px;">
            <span style="font-size: 16px; font-weight: 700; line-height: 40px;">Comparison vs latest builds</span>
            <table style="width: 100%; text-align: right; padding-top: 5px;">
                <tr>
                    <th style="background-color: #fbfbfb; min-width: 80px; padding: 5px; text-align: left; ">Date</th>
                    <th style="background-color: #fbfbfb;">Ttl req, count</th>
                    <th style="background-color: #fbfbfb;">Diff, count</th>
                    <th style="background-color: #fbfbfb;">Thrghpt, req/sec</th>
                    <th style="background-color: #fbfbfb;">Diff, req/sec</th>
                    <th style="background-color: #fbfbfb;">Error rate, %</th>
                    <th style="background-color: #fbfbfb;">Diff, %</th>
                    <th style="background-color: #fbfbfb;">Pct95, sec</th>
                    <th style="background-color: #fbfbfb;">Diff, sec</th>
                </tr>
                {% for metric in comparison %}
                <tr>
                    <td style="text-align: left;">{{metric.date}}</td>
                    <td>{{metric.total}}</td>
                    <td>{{metric.total_diff}}</td>
                    <td>{{metric.throughput}}</td>
                    <td>{{metric.throughput_diff}}</td>
                    <td>{{metric.error_rate}}</td>
                    <td>{{metric.error_rate_diff}}</td>
                    <td>{{metric.pct95}}</td>
                    <td>{{metric.pct95_diff}}</td>
                </tr>
                {% endfor %}
            </table>
            <span style="font-size: 16px; font-weight: 700; line-height: 40px;">Results summary table</span>
            <table style="width: 100%; text-align: right; padding-top: 5px;">
                <tr>
                    <th style="width: 30%; max-width: 180px; min-width: 120px; background-color: #fbfbfb; padding: 5px; text-align: left; ">Name</th>
                    <th style="background-color: #fbfbfb;">Ttl req, count</th>
                    <th style="background-color: #fbfbfb;">Thrghpt, req/sec</th>
                    <th style="background-color: #fbfbfb;">Errors, count</th>
                    <th style="background-color: #fbfbfb;">Min, sec</th>
                    <th style="background-color: #fbfbfb;">Pct50, sec</th>
                    <th style="background-color: #fbfbfb;">Pct95, sec</th>
                    <th style="background-color: #fbfbfb;">Max, sec</th>
                </tr>
                {% for request in summary %}
                <tr>
                    <td style="text-align: left;">{{ request.request_name }}</td>
                    <td>{{ request.total }}</td>
                    <td>{{ request.throughput }}</td>
                    <td>{{ request.ko }}</td>
                    <td style="color:{{ request.min_threshold }}">{{ (request.min /1000.0)|round(2, 'floor') }}</td>
                    <td style="color:{{ request.pct50_threshold }}">{{ (request.pct50 /1000.0)|round(2, 'floor') }}</td>
                    <td style="color:{{ request.pct95_threshold }}">{{ (request.pct95 /1000.0)|round(2, 'floor') }}</td>
                    <td style="color:{{ request.max_threshold }}">{{ (request.max /1000.0)|round(2, 'floor') }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <div style="width: 80%; padding: 5px; margin: auto;"></div>
    <div style="width: 80%; border-radius: 8px; margin: auto; background-color: white; max-width: 1000px; min-width: 500px;">
        <div style="margin: 0 20px 0 20px; padding-top: 20px; padding-bottom: 20px; font-size: 14px;">
            <span style="font-size: 16px; font-weight: 700; line-height: 40px;">Success Rate</span>
            <div style="text-align: center;">
                <img src="cid:success_rate" style="max-width: 100%; height: auto;" />
            </div>
            <span style="font-size: 16px; font-weight: 700; line-height: 40px;">RPS/TPS Rate</span>
            <div style="text-align: center;">
                    <img src="cid:throughput" style="max-width: 100%; height: auto;" />
            </div>
        </div>
    </div>
    <div style="width: 80%; padding: 5px; margin: auto;"></div>
    <div style="width: 80%; margin: auto; padding-bottom: 5px; text-align: center; max-width: 1000px; min-width: 500px;">
        <p style="color: white; font-size: 12px;">Auto generated performance analysis report</p>
        <p style="color: white; font-size: 12px;">&#9400; https://getcarrier.io</p>
    </div>
</body>